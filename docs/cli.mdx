---
title: CLI Operations
description: Operator runbook for pairing checks, provider auth bootstrap, and manual event ingress.
---

Use this page for day-to-day CLI actions. Protocol details live in [Integrations](./integrations/index.mdx).

## Core commands

```bash
crab pair test [--admin-socket <path>] [--timeout <duration>]
crab pair tool <endpoint> <name> [--admin-socket <path>] [--timeout <duration>]
crab pair subscriber <endpoint> <name> [--admin-socket <path>] [--timeout <duration>]
crab pair cli <endpoint> <name> [--admin-socket <path>] [--timeout <duration>]
crab event send <text>
crab auth codex [--auth-file <path>] [--timeout <duration>]
crab auth anthropic [--auth-file <path>] [--timeout <duration>]
crab auth claude [--auth-file <path>] [--mode <max|console>] [--timeout <duration>]
```

## Pairing command mapping

- `crab pair tool ...` maps to `component_type=tool_host`.
- `crab pair subscriber ...` maps to `component_type=subscriber`.
- `crab pair cli ...` maps to `component_type=operator` (`cli_admin` role profile).
- `<name>` becomes `component_id` for the paired record.

For full handshake phases and validation rules, see [Integration Pairing Flow](./integrations/pairing.mdx).

## Provider auth bootstrap

- `crab auth codex` runs OAuth + PKCE with localhost callback + manual fallback.
- `crab auth anthropic` runs OAuth + PKCE with manual code/redirect paste.
- `crab auth claude` runs setup-token auth flow (`--mode max|console`) and writes token-backed credentials.
- Default auth path resolution: `./.crabstack/auth/*.json` when local `./.crabstack` exists, otherwise `~/.crabstack/auth/*.json`.
- `--auth-file` can override credential output path on all auth subcommands.
- Credential files and parent directories should be owner-only readable/writable.
- Monitor provider auth states (`valid`, `expiring`, `reauth_required`) and re-auth before outages.

## One-shot event ingress

- `crab event send <text>` publishes `channel.message.received` to gateway `POST /v1/events`.
- Default source values are CLI-oriented (`platform=cli`, `channel=cli`).
- Each invocation creates a new session id by default, so use it for quick operator tests, not long chat continuity.

## Risk checks before production use

1. Keep admin socket local-only and verify pairing trigger is never exposed on public ingress.
2. Enforce mTLS for all remote endpoints.
3. Confirm paired identity records exist before expecting remote runtime calls to succeed.
